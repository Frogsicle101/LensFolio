<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Lensfolio | Portfolio</title>
    <!--/*/ <th:block th:include="fragments/general.html :: headerfiles">
            </th:block> /*/-->


</head>
<body>
<!--The below section <header> pulls the fragment from fragments/general-->
<header th:insert="fragments/general.html :: header"></header>

<section>
    <script th:inline="javascript">
        /*<![CDATA[*/

        let projectStart = /*[[${project.getStartDateAsLocalDateTime()}]]*/ 'default';
        let projectId = /*[[${project.getId()}]]*/ 'default';
        let projectEnd = /*[[${project.getEndDateAsLocalDateTime()}]]*/ 'default';
        let eventNameLengthRestriction = /*[[${eventNameLengthRestriction}]]*/ 'default';
        let titleRegex = /*[[${titleRegex}]]*/ 'default';
        let nextMilestoneNumber = /*[[${nextMilestoneNumber}]]*/ 'default';
        /*]]>*/
    </script>

    <!--Below are the divs that handle error messages
            If there is an attribute with either "errorMessage", "successMessage", or "infoMessage,
            they will be displayed below-->
    <div th:insert="fragments/general.html :: errorBox"></div>
    <div th:insert="fragments/general.html :: successBox"></div>
    <div th:insert="fragments/general.html :: infoBox"></div>
    <div class="projectDetails">
        <div id="project-details">
            <h1 id="projectId" style="display: none" th:text="${project.getId()}"></h1>
            <div class="mb3">
                <h1 id="projectName" th:text="${project.getName()}"></h1>
            </div>
            <div class="row">
                <div class="col-2">
                    <h6>Start</h6>
                    <h6 id="project-start-date" th:text="${project.getStartDateFormatted()}"></h6>
                </div>
                <div class="col-2">
                    <h6>End</h6>
                    <h6 id="project-end-date" th:text="${project.getEndDateFormatted()}"></h6>
                </div>
            </div>
            <div class="mb-3">
                <p id="projectDescription" th:text="${project.getDescription()}"></p>
            </div>
        </div>
        <div th:if="${userCanEdit == true}">
            <button class="btn btn-outline-success project-add-sprint-button authenticated-user" id="editProject">
                Edit Project
            </button>
            <button class="btn btn-outline-success project-add-sprint-button authenticated-user addSprint"
                    data-bs-placement="top" data-bs-toggle="tooltip" id="projectAddSprint" title="Add Sprint!">
                Add Sprint
            </button>
            <div id="sprintAddInformationBar">
            </div>
        </div>
    </div>
    <div class="projectContainer">
        <div class="eventContainer">
            <div class="infoMessageParent alert alert-primary alert-dismissible fade show" id="informationBar"
                 role="alert" style="display: none">
            </div>
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <button class="nav-link active" data-bs-target="#events" data-bs-toggle="tab" id="eventsTab"
                            role="tab">Events
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-target="#deadlines" data-bs-toggle="tab" id="deadlinesTab"
                            role="tab">Deadlines
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-target="#milestones" data-bs-toggle="tab" id="milestonesTab"
                            role="tab">Milestones
                    </button>
                </li>
            </ul>
            <div class="tab-content" id="tabContent">
                <!---------------------------------------- Events tab  ------------------------------------------>
                <div class="tab-pane fade show active" id="events" role="tabpanel">
                    <div class="mb-2 occasionAddButton">
                        <button class="addOccasionButton addEventButton noStyleButton" data-bs-placement="right"
                                data-bs-toggle="tooltip"
                                th:if="${userCanEdit == true}" title="Create Event" type="button">
                            <svg class="bi bi-plus-circle addEventSvg" fill="currentColor" height="20"
                                 viewBox="0 0 16 16"
                                 width="20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="eventForm" style="display: none" th:if="${userCanEdit == true}">
                        <form id="addEventForm">
                            <div class="mb-1">
                                <label class="form-label" for="eventName">Event name</label>
                                <input class="form-control form-control-sm" id="eventName"
                                       name="eventName" required
                                       th:maxlength="${eventNameLengthRestriction}"
                                       th:pattern="${titleRegex}"
                                       type="text">
                                <small class="form-text-counted text-muted countChar">0 characters remaining</small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" for="exampleFormControlInput1">Type of event</label>
                                <select class="form-select typeOfEvent" id="exampleFormControlInput1">
                                    <option selected value="1">Event</option>
                                    <option value="2">Test</option>
                                    <option value="3">Meeting</option>
                                    <option value="4">Workshop</option>
                                    <option value="5">Special Event</option>
                                    <option value="6">Attention Required</option>
                                </select>
                            </div>
                            <div class="row mb-1">
                                <div class="col">
                                    <label class="form-label" for="eventStart">Start</label>
                                    <input class="form-control form-control-sm eventInputStartDate eventDateInput"
                                           id="eventStart"
                                           name="eventStart"
                                           required
                                           th:max="${project.getEndDateAsLocalDateTime()}"
                                           th:min="${project.getStartDateAsLocalDateTime()}"
                                           th:value="${project.getStartDateAsLocalDateTime()}"
                                           type="datetime-local">
                                </div>
                                <div class="col">
                                    <label class="form-label" for="eventEnd">End</label>
                                    <input class="form-control form-control-sm eventInputEndDate eventDateInput" id="eventEnd"
                                           name="eventEnd"
                                           required
                                           th:max="${project.getEndDateAsLocalDateTime()}"
                                           th:min="${project.getStartDateAsLocalDateTime()}"
                                           th:value="${project.getStartDateAsLocalDateTime()}"
                                           type="datetime-local">
                                </div>
                            </div>
                            <div class="invalid-feedback">Start date must be before end date</div>
                            <div class="mb-1">
                                <button class="btn btn-primary" id="eventSubmit" type="submit">Submit</button>
                            </div>
                        </form>
                    </div>
                    <div id="eventContainer">
                    </div>
                </div>
                <!--------------------------------------- Deadlines tab  ---------------------------------------->
                <div class="tab-pane fade show" id="deadlines" role="tabpanel">
                    <div class="mb-2 occasionAddButton">
                        <button class="addDeadlineButton noStyleButton" data-bs-placement="right"
                                data-bs-toggle="tooltip"
                                th:if="${userCanEdit == true}" title="Create Deadline" type="button">
                            <svg class="bi bi-plus-circle addDeadlineSvg" fill="currentColor" height="20"
                                 viewBox="0 0 16 16"
                                 width="20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="deadlineForm" style="display: none" th:if="${userCanEdit == true}">
                        <form id="addDeadlineForm">
                            <div class="mb-1">
                                <label class="form-label" for="deadlineName">Deadline name</label>
                                <input class="form-control form-control-sm" id="deadlineName"
                                       name="occasionName" required
                                       th:maxlength="${eventNameLengthRestriction}"
                                       th:pattern="${titleRegex}"
                                       type="text">
                                <small class="form-text-counted text-muted countChar">0 characters remaining</small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" for="exampleFormControlInput3">Type of deadline</label>
                                <select class="form-select typeOfDeadline" id="exampleFormControlInput3">
                                    <option selected value="1">Event</option>
                                    <option value="2">Test</option>
                                    <option value="3">Meeting</option>
                                    <option value="4">Workshop</option>
                                    <option value="5">Special Event</option>
                                    <option value="6">Attention Required</option>
                                </select>
                            </div>
                            <div class="row mb-1">
                                <div class="col">
                                    <label class="form-label" for="deadlineEnd">End</label>
                                    <input class="form-control form-control-sm deadlineInputEndDate"
                                           id="deadlineEnd"
                                           name="deadlineEnd"
                                           required
                                           th:max="${project.getEndDateAsLocalDateTime()}"
                                           th:min="${project.getStartDateAsLocalDateTime()}"
                                           th:value="${project.getStartDateAsLocalDateTime()}"
                                           type="datetime-local">
                                </div>
                            </div>
                            <div class="mb-1">
                                <button class="btn btn-primary" id="deadlineSubmit" type="submit">Submit</button>
                            </div>
                        </form>
                    </div>
                    <div id="deadlineContainer">

                    </div>
                </div>
                <!--------------------------------------- Milestones tab  --------------------------------------->
                <div class="tab-pane fade show" id="milestones" role="tabpanel">
                    <div class="mb-2 occasionAddButton">
                        <button class="addOccasionButton addMilestoneButton noStyleButton" data-bs-placement="right"
                                data-bs-toggle="tooltip"
                                th:if="${userCanEdit == true}" title="Create Milestone" type="button">
                            <svg class="bi bi-plus-circle addMilestoneSvg" fill="currentColor" height="20"
                                 viewBox="0 0 16 16"
                                 width="20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                        </button>
                    </div>

                    <div class="milestoneForm" style="display: none" th:if="${userCanEdit == true}">
                        <form>
                            <div class="mb-1">
                                <label class="form-label" for="milestoneName">Milestone name</label>
                                <input class="form-control form-control-sm" data-nextNumber="${nextMilestoneNumber}"
                                       id="milestoneName"
                                       name="milestoneName" required
                                       th:maxlength="${eventNameLengthRestriction}"
                                       th:pattern="${titleRegex}"
                                       type="text">
                                <small class="form-text-counted text-muted countChar">0 characters remaining</small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" for="exampleFormControlInput2">Type of milestone</label>
                                <select class="form-select typeOfMilestone" id="exampleFormControlInput2">
                                    <option selected value="1">Event</option>
                                    <option value="2">Test</option>
                                    <option value="3">Meeting</option>
                                    <option value="4">Workshop</option>
                                    <option value="5">Special Event</option>
                                    <option value="6">Attention Required</option>
                                </select>
                            </div>
                            <div class="row mb-1">
                                <div class="col">
                                    <label class="form-label" for="milestoneEnd">End</label>
                                    <input class="form-control form-control-sm milestoneInputEndDate"
                                           id="milestoneEnd"
                                           name="milestoneEnd"
                                           required
                                           th:max="${project.getEndDateAsLocalDateTime().toLocalDate()}"
                                           th:min="${project.getStartDateAsLocalDateTime().toLocalDate()}"
                                           th:value="${defaultOccasionDate}"
                                           type="date">
                                </div>
                            </div>
                            <div class="mb-1">
                                <button class="btn btn-primary" id="milestoneSubmit" type="submit">Submit</button>
                            </div>
                        </form>
                    </div>
                    <div id="milestoneContainer">
                    </div>
                </div>
            </div>
        </div>

        <div class="sprintsContainer" style="display: none">
        </div>
    </div>
</section>


</body>

<script th:src="@{js/notifications.js}" type="application/javascript"></script>
<script th:src="@{js/events.js}" type="application/javascript"></script>
<script th:src="@{js/project.js}" type="application/javascript"></script>

</html>